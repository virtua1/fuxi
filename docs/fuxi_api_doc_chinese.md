# Fuxi 2.0 API Document

## 0x00 介绍

该文档是对 fuxi 2.0 版本接口进行说明

fuxi 2.0 后端采用 `python flask-restful` ，接口按照 restful 规范编写。

## 0x01 接口认证

### 接口认证方式

接口采用进行身份认证 token，访问后端接口均需要带有token字段，token 可以通过get、post等方式传入，但建议将token放在header中。调用方式如下：

```bash
GET: http://x.x.x.x/api/v1/who?token=db4bf8e722e8aaf8e352d4349b5d1e5a6095d1d0
POST: {"data": "xxx"}&token=db4bf8e722e8aaf8e352d4349b5d1e5a6095d1d0
Header: {"token": db4bf8e722e8aaf8e352d4349b5d1e5a6095d1d0}
```

### 如何获取token

```
/api/v1/token?username=fuxi&password=whoami
```

### 关于用户权限

fuxi 为默认管理员用户，默认密码为 `whoami`

fuxi 作为管理员具备完全用户管理权限，可以新增用户，修改用户信息、删除用户、修改密码等

普通用户具备平台使用及修改当前用户信息权限



## 0x02 接口列表

以下所有接口无特殊说明，均需传入token，不再做具体说明

### 账号管理相关接口

#### /api/v1/token

接口描述：用户token管理

| 请求模式 | 参数                                                       | 功能描述          |
| -------- | ---------------------------------------------------------- | ----------------- |
| GET      | username(string, required)<br />password(string, required) | 获取当前用户token |
| PUT      | username(string, required)<br />password(string, required) | 刷新当前用户token |

#### /api/v1/who

接口描述：获取用户基本信息

| 请求模式 | 参数 | 功能描述             |
| -------- | ---- | -------------------- |
| GET      |      | 获取当前用户基本信息 |

#### /api/v1/admin

接口描述：账号管理

| 请求模式 | 参数                                                         | 功能描述             |
| -------- | ------------------------------------------------------------ | -------------------- |
| GET      | username(string,required)<br />password(string,required)<br />nick(string)<br />email(string) | 获取当前用户基本信息 |
| PUT      | username(string,required)<br />password(string,required)     | 修改用户密码         |

#### /api/v1/settings/user

接口描述：获取用户列表

| 请求模式 | 参数 | 功能描述         |
| -------- | ---- | ---------------- |
| GET      |      | 获取当前用户列表 |

### /api/v1/settings/user/<uid>

接口描述：获取用户列表

| 请求模式 | 参数                                                  | 功能描述     |
| -------- | ----------------------------------------------------- | ------------ |
| DELETE   |                                                       | 删除用户     |
| PUT      | username(string)<br />nick(string)<br />email(string) | 修改用户信息 |



### poc扫描模块接口

#### /api/v1/scanner/poc/task

接口描述：新增poc扫描任务，获取当前任务列表

| 请求模式 | 参数                                                         | 参数描述                                                     | 接口描述         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------- |
| GET      |                                                              |                                                              | 获取扫描任务列表 |
| POST     | name(string,required)<br />target(string,required) <br />poc(string,required)<br />threads(int)<br />freq(string,required) | 任务名称<br />扫描对象，以逗号分隔<br />扫描插件ID，以逗号分隔<br />任务周期：daily weekly monthly | 新增扫描任务     |

#### /api/v1/scanner/poc/task/<tid>

接口描述：poc扫描任务管理

| 请求模式 | 参数                     | 参数描述                 | 接口描述     |
| -------- | ------------------------ | ------------------------ | ------------ |
| DELETE   |                          |                          | 获取任务列表 |
| DELETE   |                          |                          | 删除任务     |
| PUT      | action(string, required) | 动作：如rescan(重新扫描) | 修改任务状态 |

####  /api/v1/scanner/poc/plugin

接口描述：获取插件列表及上传插件

| 请求模式 | 参数 | 参数描述 | 接口描述     |
| -------- | ---- | -------- | ------------ |
| GET      |      |          | 获取插件列表 |
| DELETE   | file | FormData | 删除任务     |

#### /api/v1/scanner/poc/plugin/<pid>

接口描述：通过 pid 获取poc插件信息、poc插件管理

| 请求模式 | 参数 | 参数描述 | 接口描述            |
| -------- | ---- | -------- | ------------------- |
| GET      |      |          | 通过pid获取插件信息 |
| DELETE   |      |          | 删除poc插件         |

#### /api/v1/scanner/poc/vul

接口描述：获取poc扫描发现的漏洞列表

| 请求模式 | 参数                                                       | 参数描述                                                     | 接口描述            |
| -------- | ---------------------------------------------------------- | ------------------------------------------------------------ | ------------------- |
| GET      | task_id(string)<br />plugin_id(string)<br />search(string) | 获取该任务下漏洞列表<br />获取该插件下漏洞列表<br />关键字筛选 | 通过pid获取插件信息 |
|          |                                                            |                                                              |                     |

#### /api/v1/scanner/poc/vul/<vul_id>

接口描述：漏洞管理

| 请求模式 | 参数 | 参数描述 | 接口描述                   |
| -------- | ---- | -------- | -------------------------- |
| GET      |      |          | 通过漏洞ID获取漏洞详细信息 |
| DELETE   |      |          | 删除漏洞                   |

#### /api/v1/scanner/poc/export

接口描述：扫描结果导出

| 请求模式 | 参数                               | 参数描述 | 接口描述            |
| -------- | ---------------------------------- | -------- | ------------------- |
| GET      | tid(string)<br />pid(string)<br /> | 任务ID   | 导出xls格式扫描结果 |



### Jsonp 劫持漏洞利用

#### /api/v1/exploit/jsonp/task

接口描述：jsonp劫持任务创建及管理

| 请求模式 | 参数                                            | 参数描述                    | 接口描述     |
| -------- | ----------------------------------------------- | --------------------------- | ------------ |
| GET      |                                                 |                             | 获取任务列表 |
| POST     | name(string,required)<br />url(string,required) | 任务名称<br />待劫持目标URL | 新增劫持任务 |

#### /api/v1/exploit/jsonp/task/<tid>

接口描述：jsonp劫持任务管理

| 请求模式 | 参数 | 参数描述 | 接口描述 |
| -------- | ---- | -------- | -------- |
| GET      |      |          | 删除任务 |

#### /api/v1/exploit/jsonp/task/list/<tid>

接口描述： 获取Jsonp任务劫持数据

| 请求模式 | 参数 | 参数描述 | 接口描述           |
| -------- | ---- | -------- | ------------------ |
| GET      |      |          | 获取该任务劫持结果 |

#### /api/v1/exploit/jsonp/result

接口描述： 获取Jsonp劫持数据

| 请求模式 | 参数 | 参数描述 | 接口描述         |
| -------- | ---- | -------- | ---------------- |
| GET      |      |          | 获取所有劫持结果 |

#### /api/v1/exploit/jsonp/res/<rid>

接口描述： 对Jsonp劫持到的数据进行管理

| 请求模式 | 参数 | 参数描述 | 接口描述     |
| -------- | ---- | -------- | ------------ |
| GET      |      |          | 删除劫持数据 |

#### /api/v1/exploit/jsonp/data

接口描述： 对Jsonp劫持数据接收接口

| 请求模式 | 参数                                           | 参数描述 | 接口描述              |
| -------- | ---------------------------------------------- | -------- | --------------------- |
| GET      | d(string,required)<br />link(string, required) |          | 接收jsonp劫持到的数据 |



### HTTP Log 请求记录

#### /http

接口描述：用于无回显漏洞验证，接收数据及验证数据是否存在

| 请求模式 | 参数                             | 参数描述                       | 接口描述                                 |
| -------- | -------------------------------- | ------------------------------ | ---------------------------------------- |
| GET      | data(string)<br />verify(string) | 接收数据<br />验证数据是否存在 | 接收无回显请求<br />验证请求记录是否存在 |

#### /api/v1/exploit/http

接口描述：用于无回显漏洞验证，获取请求记录

| 请求模式 | 参数            | 参数描述   | 接口描述               |
| -------- | --------------- | ---------- | ---------------------- |
| GET      | keyword(string) | 关键字筛选 | 接收无回显请求记录列表 |

#### /api/v1/exploit/http/<hid>

接口描述：无回显记录管理

| 请求模式 | 参数 | 参数描述 | 接口描述     |
| -------- | ---- | -------- | ------------ |
| DELELE   |      |          | 删除请求记录 |



### XSS 模块

#### /api/v1/exploit/xss/task

接口描述：创建 XSS 数据接收任务，获取 xss 任务列表等

| 请求模式 | 参数                                                | 参数描述                     | 接口描述              |
| -------- | --------------------------------------------------- | ---------------------------- | --------------------- |
| GET      |                                                     |                              | 获取任务列表          |
| POST     | name(string,required)<br />payload(string,required) | 任务名称<br />XSS Payload ID | 新增 xss 漏洞接收任务 |

#### /api/v1/exploit/xss/task/<tid>

接口描述：xss 接收任务管理

| 请求模式 | 参数 | 参数描述 | 接口描述 |
| -------- | ---- | -------- | -------- |
| DELELE   |      |          | 删除任务 |

#### /api/v1/exploit/xss/task/res/<tid>

接口描述：获取xss接收任务结果

| 请求模式 | 参数 | 参数描述 | 接口描述            |
| -------- | ---- | -------- | ------------------- |
| GET      |      |          | 获取xss接收任务结果 |

#### /api/v1/exploit/xss/result

接口描述：接收到的 xss 数据列表

| 请求模式 | 参数 | 参数描述 | 接口描述                |
| -------- | ---- | -------- | ----------------------- |
| GET      |      |          | 获取xss接收到的数据列表 |

#### /api/v1/exploit/xss/result/<rid>

接口描述：xss 接收数据管理

| 请求模式 | 参数 | 参数描述 | 接口描述 |
| -------- | ---- | -------- | -------- |
| DELELE   |      |          | 删除数据 |

#### /api/v1/exploit/xss/payload

接口描述：xss payload创建，获取xss payload列表

| 请求模式 | 参数                                              | 参数描述                      | 接口描述            |
| -------- | ------------------------------------------------- | ----------------------------- | ------------------- |
| GET      |                                                   |                               | 获取xss payload列表 |
| POST     | name(string,required)<br />value(string,required) | Payload名称<br />Payload 内容 | 新增 xss payload    |

#### /api/v1/exploit/xss/payload/<pid>

接口描述：XSS Payload管理

| 请求模式 | 参数                   | 参数描述     | 接口描述          |
| -------- | ---------------------- | ------------ | ----------------- |
| DELELE   |                        |              | 删除 payload      |
| PUT      | value(string,required) | Payload 内容 | 修改 payload 内容 |



### 网络端口扫描模块

#### /api/v1/discovery/port/task

接口描述：端口扫描任务创建，获取扫描任务列表

| 请求模式 | 参数                                                         | 参数描述                                                     | 接口描述         |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---------------- |
| GET      |                                                              |                                                              | 获取扫描任务列表 |
| POST     | name(string,required)<br />target(string,required) <br />port(string)<br />option | 任务名称<br />扫描对象以逗号分隔<br />扫描端口( 1-65535 等)<br />特殊选项 | 新增扫描任务     |

#### /api/v1/discovery/port/task/<tid>

接口描述：端口扫描任务管理

| 请求模式 | 参数                    | 参数描述     | 接口描述         |
| -------- | ----------------------- | ------------ | ---------------- |
| GET      |                         |              | 获取扫描任务详情 |
| PUT      | rescan(string,required) | 任务重新扫描 | 修改扫描任务状态 |
| DELETE   |                         |              | 删除扫描任务     |

#### /api/v1/discovery/port/task/host/<tid>

接口描述：获取扫描任务结果

| 请求模式 | 参数 | 参数描述 | 接口描述         |
| -------- | ---- | -------- | ---------------- |
| GET      |      |          | 获取扫描任务结果 |

#### /api/v1/discovery/port/host/<hid>

接口描述：获取主机端口详情

| 请求模式 | 参数 | 参数描述 | 接口描述         |
| -------- | ---- | -------- | ---------------- |
| GET      |      |          | 获取主机端口详情 |

#### /api/v1/discovery/port/export/<tid>

接口描述：扫描任务结果导出

| 请求模式 | 参数 | 参数描述 | 接口描述         |
| -------- | ---- | -------- | ---------------- |
| GET      |      |          | 获取主机端口详情 |



### 网站指纹识别

#### /api/v1/discovery/whatweb/task

接口描述：创建 whatweb 网站指纹识别扫描任务，获取任务列表

| 请求模式 | 参数                                                         | 参数描述                                                     | 接口描述     |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------ |
| GET      |                                                              |                                                              | 获取任务列表 |
| POST     | name(string,required)<br />target(string,required) <br />level(string)<br />threads(int)<br />option(string)<br />header(string)<br />cookie(string)<br />plugin(string) | 任务名称<br />扫描对象以逗号分隔<br />扫描等级<br />扫描并发<br />特殊选项<br />请求header<br />cookie<br />插件 | 新增扫描任务 |

#### /api/v1/discovery/whatweb/task/test

接口描述：创建临时简单扫描

| 请求模式 | 参数                     | 参数描述 | 接口描述     |
| -------- | ------------------------ | -------- | ------------ |
| POST     | target(string, required) | 扫描目标 | 新建临时扫描 |

#### /api/v1/discovery/whatweb/task/export/<tid>

接口描述：导出whatweb扫描任务结果

| 请求模式 | 参数 | 参数描述 | 接口描述 |
| -------- | ---- | -------- | -------- |
| GET      |      |          |          |

#### /api/v1/discovery/whatweb/task/<tid>

接口描述：扫描任务管理

| 请求模式 | 参数                    | 参数描述     | 接口描述         |
| -------- | ----------------------- | ------------ | ---------------- |
| GET      |                         |              | 获取扫描任务详情 |
| PUT      | rescan(string,required) | 任务重新扫描 | 修改扫描任务状态 |
| DELETE   |                         |              | 删除扫描任务     |

#### /api/v1/discovery/fp/search

接口描述：web 指纹搜索

| 请求模式 | 参数 | 参数描述 | 接口描述         |
| -------- | ---- | -------- | ---------------- |
| GET      |      |          | 获取扫描任务详情 |

#### /api/v1/discovery/fp/result/<rid>

接口描述：web指纹管理

| 请求模式 | 参数 | 参数描述 | 接口描述 |
| -------- | ---- | -------- | -------- |
| DELELE   |      |          | 删除数据 |

#### /api/v1/discovery/fp/export/csv

接口描述：web指纹导出

| 请求模式 | 参数                               | 参数描述   | 接口描述        |
| -------- | ---------------------------------- | ---------- | --------------- |
| GET      | keyword(string)<br />value(string) | 关键字筛选 | 导出web指纹数据 |



### 子域名扫描

#### /api/v1/discovery/whatweb/task

接口描述：创建子域名扫描任务，获取任务列表

| 请求模式 | 参数                                                         | 参数描述                                                     | 接口描述     |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------ |
| GET      |                                                              |                                                              | 获取任务列表 |
| POST     | name(string,required)<br />target(string,required) <br />brute(bool)<br />threads(int)<br />info(bool) | 任务名称<br />扫描对象以逗号分隔<br />是否进行暴力采集<br />扫描并发<br />是否进行web信息收集 | 新增扫描任务 |

#### /api/v1/discovery/subdomain/task/<tid>

接口描述：子域名扫描任务管理

| 请求模式 | 参数                    | 参数描述     | 接口描述         |
| -------- | ----------------------- | ------------ | ---------------- |
| GET      |                         |              | 获取扫描任务详情 |
| PUT      | rescan(string,required) | 任务重新扫描 | 修改扫描任务状态 |
| DELETE   |                         |              | 删除扫描任务     |

#### /api/v1/discovery/subdomain/result

接口描述：获取所有子域名数据

| 请求模式 | 参数                               | 参数描述                            | 接口描述           |
| -------- | ---------------------------------- | ----------------------------------- | ------------------ |
| GET      | keyword(string)<br />value(string) | 关键字筛选(tid)<br />检索值(tid 值) | 获取所有子域名数据 |

#### /api/v1/discovery/subdomain/result/<rid>

接口描述：子域名管理

| 请求模式 | 参数 | 参数描述 | 接口描述 |
| -------- | ---- | -------- | -------- |
| DELELE   |      |          | 删除数据 |

#### /api/v1/discovery/subdomain/export/<tid>

接口描述：导出任务子域名信息

| 请求模式 | 参数 | 参数描述 | 接口描述                   |
| -------- | ---- | -------- | -------------------------- |
| GET      |      |          | 导出任务子域名列表 xls表格 |